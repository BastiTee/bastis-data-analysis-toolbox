<svg id="figure" width="900" height="500" font-family="sans-serif" font-size="10" text-anchor="middle"></svg>
<style>
    .bar {
        fill: steelblue;
    }
</style>
<script>
    var svg = d3.select("#figure")
    var width = svg.attr("width")
    var height = svg.attr("height");
    var parseDate = d3.timeParse("%Y-%m-%d");

    // get the data
    d3.csv("examples/commits.csv", function(error, data) {
        if (error) throw error;

        // format the data
        varMax = new Date(1970, 1, 1)
        varMin = new Date(2999, 1, 1)
        data.forEach(function(d) {
            d.date = parseDate(d.date);
            if (d.date > varMax) {
                varMax = d.date;
            }
            if (d.date < varMin) {
                varMin = d.date
            }
        });
        // console.log(varMax)
        // console.log(varMin)
        // set the ranges
        var x = d3.scaleTime()
            .domain([varMin, varMax])
            .rangeRound([0, width]);
        var y = d3.scaleLinear()
            .range([height, 0]);

        // set the parameters for the histogram
        var histogram = d3.histogram()
            .value(function(d) {
                return d.date;
            })
            .domain(x.domain())
            .thresholds(x.ticks(d3.timeMonth));

        // group the data for the bars
        var bins = histogram(data);
        console.log(bins)

        // Scale the range of the data in the y domain
        y.domain([0, d3.max(bins, function(d) {
            return d.length;
        })]);

        // append the bar rectangles to the svg element
        svg.selectAll("rect")
            .data(bins)
            .enter().append("rect")
            .attr("class", "bar")
            .attr("x", 1)
            .attr("transform", function(d) {
                return "translate(" + x(d.x0) + "," + y(d.length) + ")";
            })
            .attr("width", function(d) {
                return x(d.x1) - x(d.x0) - 1;
            })
            .attr("height", function(d) {
                return height - y(d.length);
            });

        // add the x Axis
        svg.append("g")
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(x));

        // add the y Axis
        svg.append("g")
            .call(d3.axisLeft(y));

    });
</script>
